<ul>
  @for (ticket of tickets(); track ticket.id) {
    @let isVisible = displayState()[ticket.id];
    <li>
      <h3>
        <div [class.open]="ticket.isOpen"></div>
        <button (click)="toggleDisplay(ticket.id)">
          <span>{{ ticket.title }}</span>
            @if (isVisible) {
              <svg
                       xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                       class="w-6 h-6"
                     viewBox="0 0 24 24"
                      stroke="currentColor"
                stroke-width="1.5"
              >
                <path
                   stroke-linecap="round"
                  stroke-linejoin="round"
                                d="m19.5 8.25-7.5 7.5-7.5-7.5"
                />
              </svg>
              } @else {
              <svg
                  xmlns="http://www.w3.org/2000/svg"
                   fill="currentColor"
                  class="w-6 h-6"
                viewBox="0 0 24 24"
              >
                <path
                  fill-rule="evenodd"
                          d="M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z"
                  clip-rule="evenodd"
                />
              </svg>
            }
        </button>
      </h3>

      @if (isVisible) {
        <p>{{ ticket.request }}</p>
          @if (ticket.isOpen) {
            <button (click)="closeTicket(ticket.id)">Mark as completed</button>
          }
        }
    </li>
  } @empty {
    <p>No Open Tickets</p>
  }
</ul>

<app-new-ticket (add)="onAdd($event)" />
